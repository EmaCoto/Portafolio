<div id="cursor-dot" class="cursor-element"></div>
<div id="cursor-outline" class="cursor-element"></div>

<style>
  .cursor-element {
    position: fixed;
    top: 0;
    left: 0;
    pointer-events: none;
    border-radius: 50%;
    opacity: 0;
    z-index: 9999;
    will-change: transform;
    transition: opacity 0.3s ease;
  }

  #cursor-dot {
    width: 8px;
    height: 8px;
    background-color: #72bf78;
    mix-blend-mode: difference;
  }

  #cursor-outline {
    width: 40px;
    height: 40px;
    border: 1px solid rgba(114, 191, 120, 0.5);
  }

  /* Estilo base para los destellos */
  :global(.cursor-sparkle) {
    position: fixed;
    top: 0;
    left: 0;
    width: 4px;
    height: 4px;
    border-radius: 50%;
    pointer-events: none;
    z-index: 9998;
    filter: blur(0.5px);
    box-shadow: 0 0 5px rgba(255, 255, 255, 0.2);
  }

  :global(html), :global(body), :global(a), :global(button) {
    cursor: none !important;
  }

  @media (hover: none) and (pointer: coarse) {
    .cursor-element { display: none; }
    :global(html), :global(body) { cursor: auto !important; }
  }
</style>

<script>
  import { gsap } from "gsap";

  const dot = document.getElementById('cursor-dot');
  const outline = document.getElementById('cursor-outline');

  gsap.set([dot, outline], { xPercent: -50, yPercent: -50 });

  // Función para crear destellos con colores alternos
  const createSparkle = (x: number, y: number) => {
    const sparkle = document.createElement('div');
    sparkle.className = 'cursor-sparkle';
    
    // Lógica de color aleatorio (Verde o Blanco)
    const isGreen = Math.random() > 0.5;
    sparkle.style.backgroundColor = isGreen ? '#72bf78' : '#ffffff';
    
    document.body.appendChild(sparkle);

    // Posición inicial con tamaño aleatorio
    gsap.set(sparkle, { 
      x, 
      y, 
      xPercent: -50, 
      yPercent: -50, 
      scale: Math.random() * 1.2 + 0.5 
    });

    // Animación de la partícula
    gsap.to(sparkle, {
      x: x + (Math.random() - 0.5) * 60, // Más dispersión para que se note
      y: y + (Math.random() - 0.5) * 60,
      opacity: 0,
      scale: 0,
      duration: Math.random() * 0.6 + 0.4,
      ease: "power2.out",
      onComplete: () => sparkle.remove()
    });
  };

  window.addEventListener('mousemove', (e) => {
    const { clientX, clientY } = e;

    if (dot && outline) {
      dot.style.opacity = "1";
      outline.style.opacity = "1";
    }

    // Generamos destellos al movernos
    createSparkle(clientX, clientY);

    gsap.to(dot, {
      x: clientX,
      y: clientY,
      duration: 0.1,
      ease: "power2.out"
    });

    gsap.to(outline, {
      x: clientX,
      y: clientY,
      duration: 0.5,
      ease: "power3.out"
    });
  });

  const activeElements = "a, button, .group, .blog-card, .nav-item";
  document.querySelectorAll(activeElements).forEach(el => {
    el.addEventListener('mouseenter', () => {
      gsap.to(outline, { scale: 1.5, backgroundColor: "rgba(114, 191, 120, 0.1)", duration: 0.3 });
      gsap.to(dot, { scale: 0.5, duration: 0.3 });
    });
    el.addEventListener('mouseleave', () => {
      gsap.to(outline, { scale: 1, backgroundColor: "transparent", duration: 0.3 });
      gsap.to(dot, { scale: 1, duration: 0.3 });
    });
  });

  document.addEventListener('mouseleave', () => {
    gsap.to([dot, outline], { opacity: 0 });
  });
  document.addEventListener('mouseenter', () => {
    gsap.to([dot, outline], { opacity: 1 });
  });
</script>