---
// Definimos los conocimientos para el Mega Menú
const skills = [
  { name: "PHP", icon: "devicon-php-plain" },
  { name: "JavaScript", icon: "devicon-javascript-plain" },
  { name: "SQL", icon: "devicon-mysql-plain" },
  { name: "Astro", icon: "devicon-astro-plain" },
  { name: "Laravel", icon: "devicon-laravel-plain" },
  { name: "Livewire", icon: "devicon-livewire-plain-wordmark" },
  { name: "Tailwind", icon: "devicon-tailwindcss-original" },
  { name: "GitHub", icon: "devicon-github-original" },
  { name: "WordPress", icon: "devicon-wordpress-plain" },
  { name: "Optimización", icon: "devicon-chrome-plain" },
  { name: "Search Console", icon: "devicon-google-plain" },
  { name: "SEO", icon: "devicon-google-plain" },
];

const projects = [
  { name: "E-Commerce Alpha", category: "Fullstack", link: "#" },
  { name: "SaaS Dashboard", category: "UI/UX", link: "#" },
  { name: "Portfolio Tech", category: "Astro", link: "#" },
];
---



<nav id="main-nav" class="fixed top-0 left-0 w-full z-100 transition-all duration-500 py-6">
  <div class="max-w-7xl mx-auto px-6 flex justify-between items-center">
    
    <a href="/" id="logo-reload" class="group flex items-center gap-2">
      <div class="w-10 h-10 bg-[#72bf78] rounded-lg flex items-center justify-center rotate-3 group-hover:rotate-360 transition-all duration-700">
        <span class="text-[#0a0709] font-black text-xl">E</span>
      </div>
      <span class="text-white font-black tracking-tighter text-xl uppercase italic group-hover:text-[#72bf78] transition-colors underline-offset-4">
        Emanuel<span class="text-[#72bf78]">.</span>
      </span>
    </a>

    <ul class="hidden md:flex items-center gap-8 bg-white/5 backdrop-blur-md border border-white/10 px-8 py-3 rounded-full">
      <li><a href="/" id="inicio-reload" class="nav-link">Inicio</a></li>
      
      <li class="relative group/mega">
        <button class="nav-link flex items-center gap-1 group-hover/mega:text-[#72bf78]">
          Conocimientos <svg class="w-3 h-3 transition-transform group-hover/mega:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
        </button>
        <div class="absolute top-full left-1/2 -translate-x-1/2 mt-4 w-125 bg-[#0d0d0d] border border-white/10 rounded-2xl p-6 opacity-0 invisible group-hover/mega:opacity-100 group-hover/mega:visible transition-all duration-300 translate-y-2 group-hover/mega:translate-y-0 shadow-[0_20px_50px_rgba(0,0,0,0.5)]">
          <div class="grid grid-cols-3 gap-4">
            {skills.map(skill => (
              <div class="flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 transition-colors group/item">
                <i class={`${skill.icon} text-2xl text-white/40 group-hover/item:text-[#72bf78] transition-colors`}></i>
                <span class="text-xs font-mono text-white/60 group-hover/item:text-white uppercase tracking-widest">{skill.name}</span>
              </div>
            ))}
          </div>
        </div>
      </li>

      <li class="relative group/mega">
        <button class="nav-link flex items-center gap-1 group-hover/mega:text-[#72bf78]">
          Proyectos <svg class="w-3 h-3 transition-transform group-hover/mega:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
        </button>
        <div class="absolute top-full left-1/2 -translate-x-1/2 mt-4 w-87.5 bg-[#0d0d0d] border border-white/10 rounded-2xl p-4 opacity-0 invisible group-hover/mega:opacity-100 group-hover/mega:visible transition-all duration-300 translate-y-2 group-hover/mega:translate-y-0">
          <div class="flex flex-col gap-2">
            {projects.map(proj => (
              <a href={proj.link} class="flex justify-between items-center p-4 rounded-xl hover:bg-[#72bf78]/10 border border-transparent hover:border-[#72bf78]/20 transition-all group/p">
                <div>
                  <h4 class="text-white text-sm font-bold uppercase italic leading-none">{proj.name}</h4>
                  <p class="text-[10px] text-white/40 uppercase tracking-widest mt-1">{proj.category}</p>
                </div>
                <svg class="w-4 h-4 text-[#72bf78] opacity-0 -translate-x-2 group-hover/p:opacity-100 group-hover/p:translate-x-0 transition-all" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/></svg>
              </a>
            ))}
            <div class="h-px bg-white/5 my-2"></div>
            <a href="/proyectos" class="text-center text-[10px] text-[#72bf78] font-bold uppercase tracking-[0.3em] hover:tracking-[0.5em] transition-all">Ver todos</a>
          </div>
        </div>
      </li>

      <li><a href="#formation" class="nav-link">Formación</a></li>
      <li><a href="#blog" class="nav-link">Blog</a></li>
    </ul>

    <button id="menu-toggle" class="md:hidden flex flex-col gap-1.5 z-110">
      <span class="w-8 h-0.5 bg-white transition-all duration-300 origin-center"></span>
      <span class="w-8 h-0.5 bg-[#72bf78] transition-all duration-300"></span>
      <span class="w-8 h-0.5 bg-white transition-all duration-300 origin-center"></span>
    </button>
  </div>

  <div id="mobile-menu" class="fixed inset-0 bg-[#0a0709] z-105 translate-x-full transition-transform duration-500 flex flex-col items-center justify-center gap-8 text-center">
    <a href="/" class="mobile-link text-4xl font-black uppercase italic">Inicio</a>
    <a href="#" class="mobile-link text-4xl font-black uppercase italic">Conocimientos</a>
    <a href="#" class="mobile-link text-4xl font-black uppercase italic">Proyectos</a>
    <a href="#" class="mobile-link text-4xl font-black uppercase italic">Formación</a>
    <a href="#" class="mobile-link text-4xl font-black uppercase italic">Blog</a>
  </div>
</nav>

<style>
  @reference "../style/global.css";

  .nav-link {
    @apply text-white/60 font-mono text-[11px] uppercase tracking-[0.2em] transition-all hover:text-white relative flex items-center h-full;
    background: none;
    border: none;
    cursor: pointer;
  }

  .nav-link::after {
    content: '';
    @apply absolute -bottom-1 left-0 w-0 h-px bg-[#72bf78] transition-all;
  }

  .nav-link:hover::after {
    @apply w-full;
  }

  .nav-link svg {
    @apply ml-1 mb-0.5;
  }

  .mobile-link {
    @apply text-white hover:text-[#72bf78] transition-colors;
  }
  
  .nav-scrolled {
    @apply py-3 bg-[#0a0709]/80 backdrop-blur-xl border-b border-white/5 shadow-2xl;
  }

  .menu-active span:nth-child(1) { transform: translateY(8px) rotate(45deg); }
  .menu-active span:nth-child(2) { opacity: 0; transform: translateX(20px); }
  .menu-active span:nth-child(3) { transform: translateY(-8px) rotate(-45deg); }
</style>

<script>
  import { gsap } from "gsap";

  const navbar = document.getElementById('main-nav');
  const menuToggle = document.getElementById('menu-toggle');
  const mobileMenu = document.getElementById('mobile-menu');
  
  // Selección de elementos para recarga forzada
  const logoReload = document.getElementById('logo-reload');
  const inicioReload = document.getElementById('inicio-reload');

  const handleReload = (e: MouseEvent) => {
    e.preventDefault();
    window.location.href = '/'; // Forzamos la navegación a la raíz
  };

  logoReload?.addEventListener('click', handleReload);
  inicioReload?.addEventListener('click', handleReload);

  window.addEventListener('scroll', () => {
    if (window.scrollY > 50) {
      navbar?.classList.add('nav-scrolled');
    } else {
      navbar?.classList.remove('nav-scrolled');
    }
  });

  let menuOpen = false;
  menuToggle?.addEventListener('click', () => {
    menuOpen = !menuOpen;
    menuToggle.classList.toggle('menu-active');
    mobileMenu?.classList.toggle('translate-x-0');
    mobileMenu?.classList.toggle('translate-x-full');
    
    if (menuOpen) {
      gsap.from(".mobile-link", {
        y: 50,
        opacity: 0,
        stagger: 0.1,
        ease: "back.out(1.7)",
        duration: 0.6
      });
    }
  });
</script>